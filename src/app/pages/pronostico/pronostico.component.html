<div class="formulario-container" *ngIf="usuarioId">
  <form (ngSubmit)="enviarPronostico()">
    <h2>Hola {{ nombreUsuario }}, haz tu pronóstico</h2>
    <p>
      Tus puntos: <strong>{{ puntos }}</strong>
    </p>

    <select [(ngModel)]="partidoId" name="partidoId" required>
      <option value="">-- Selecciona un partido --</option>
      <option *ngFor="let p of partidos" [value]="p.id">
        {{ p.local }} vs {{ p.visitante }}
      </option>
    </select>

    <p *ngIf="partidoSeleccionado">
      Fecha de cierre:
      <strong>{{
        partidoSeleccionado.fechaLimite.seconds * 1000
          | date : "dd/MM/yyyy, h:mm a"
      }}</strong>
    </p>

    <div
      style="display: flex; gap: 10px; align-items: center; margin-top: 10px"
    >
      <div style="flex: 1">
        <label style="display: block; font-weight: bold; margin-bottom: 4px">
          {{ partidoSeleccionado?.local || "Local" }}
        </label>
        <input
          type="number"
          [(ngModel)]="golesLocal"
          name="golesLocal"
          required
          style="width: 100%"
        />
      </div>

      <div style="flex: 1">
        <label style="display: block; font-weight: bold; margin-bottom: 4px">
          {{ partidoSeleccionado?.visitante || "Visitante" }}
        </label>
        <input
          type="number"
          [(ngModel)]="golesVisitante"
          name="golesVisitante"
          required
          style="width: 100%"
        />
      </div>
    </div>

    <button type="submit">Enviar Pronóstico</button>

    <p *ngIf="mensaje" class="mensaje">{{ mensaje }}</p>
  </form>

  <h3>Mis pronósticos</h3>
  <p *ngIf="pronosticos.length === 0">No has hecho pronósticos todavía.</p>

  <table *ngIf="pronosticos.length > 0" class="tabla-pronosticos">
    <thead>
      <tr>
        <th>Partido</th>
        <th>Goles Local</th>
        <th>Goles Visitante</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let p of pronosticos">
        <td>{{ p.partidoId }}</td>
        <td>{{ p.golesLocal }}</td>
        <td>{{ p.golesVisitante }}</td>
        <td>{{ p.fechaHora | date : "short" }}</td>
      </tr>
    </tbody>
  </table>
</div>
